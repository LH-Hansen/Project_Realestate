<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
    x:Class="RealEstateApp.Views.AddEditPropertyPage"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:converters="clr-namespace:RealEstateApp.Converters"
    xmlns:fa="clr-namespace:FontAwesome"
    xmlns:vm="clr-namespace:RealEstateApp.ViewModels"
    Title="{Binding Title}"
    BackgroundColor="#F5F5F5"
    x:DataType="vm:AddEditPropertyPageViewModel">

    <ContentPage.ToolbarItems>
        <ToolbarItem Command="{Binding CancelSaveCommand}" Text="Cancel" />
        <ToolbarItem Command="{Binding SavePropertyCommand}" Text="Save" />
    </ContentPage.ToolbarItems>

    <ContentPage.Content>
        <StackLayout BackgroundColor="#F5F5F5">
            <Label
                BackgroundColor="{Binding StatusColor}"
                IsVisible="{Binding StatusMessage, Converter={converters:StringBoolConverter}}"
                Text="{Binding StatusMessage}"
                TextColor="White" />

            <ScrollView VerticalOptions="FillAndExpand">
                <StackLayout Padding="15" Spacing="20">

                    <!-- Address -->
                    <Label>
                        <Label.FormattedText>
                            <FormattedString>
                                <Span FontFamily="FA-solid"
                                      Text="{x:Static fa:IconFont.Home}" />
                                <Span Text=" Address*" />
                            </FormattedString>
                        </Label.FormattedText>
                    </Label>

                    <Entry
                        BackgroundColor="White"
                        Placeholder="Enter address"
                        Text="{Binding Property.Address}" />

                    <!-- Location -->
                    <Label FontSize="Medium" TextColor="#1F1F1F">
                        <Label.FormattedText>
                            <FormattedString>
                                <Span FontFamily="FA-solid"
                  FontSize="14"
                  Text="{x:Static fa:IconFont.LocationArrow}"
                  TextColor="#757575" />
                                <Span Text=" " />
                                <Span FontSize="14"
                  Text="Location"
                  TextColor="#1F1F1F" />
                            </FormattedString>
                        </Label.FormattedText>
                    </Label>

                    <Grid ColumnDefinitions="*,*,Auto"
      ColumnSpacing="10">

                        <Entry Grid.Column="0"
           BackgroundColor="White"
           IsReadOnly="True"
           Text="{Binding Property.Latitude}"
           TextColor="#1F1F1F"
           Placeholder="Latitude"
           PlaceholderColor="#BDBDBD"/>

                        <Entry Grid.Column="1"
           BackgroundColor="White"
           IsReadOnly="True"
           Text="{Binding Property.Longitude}"
           TextColor="#1F1F1F"
           Placeholder="Longitude"
           PlaceholderColor="#BDBDBD"/>

                        <Button Grid.Column="2"
            Command="{Binding GetLocationCommand}"
            FontFamily="FA-solid"
            Text="{x:Static fa:IconFont.Thumbtack}"
            WidthRequest="50"
            HeightRequest="50"
            VerticalOptions="Center"/>
                    </Grid>


                    <!-- Remaining existing fields unchanged -->
                    <!-- Price -->
                    <Label Text="Price*" />
                    <Entry BackgroundColor="White"
                           Keyboard="Numeric"
                           Text="{Binding Property.Price,
                           Converter={converters:NullableIntConverter}}" />

                    <!-- Bedrooms -->
                    <Label Text="Bedrooms*" />
                    <Entry BackgroundColor="White"
                           Keyboard="Numeric"
                           Text="{Binding Property.Beds,
                           Converter={converters:NullableIntConverter}}" />

                    <!-- Bathrooms -->
                    <Label Text="Bathrooms" />
                    <Entry BackgroundColor="White"
                           Keyboard="Numeric"
                           Text="{Binding Property.Baths,
                           Converter={converters:NullableIntConverter}}" />

                    <!-- Parking -->
                    <Label Text="Parking" />
                    <Entry BackgroundColor="White"
                           Keyboard="Numeric"
                           Text="{Binding Property.Parking,
                           Converter={converters:NullableIntConverter}}" />

                    <!-- Land Size -->
                    <Label Text="Land Size" />
                    <Entry BackgroundColor="White"
                           Keyboard="Numeric"
                           Text="{Binding Property.LandSize,
                           Converter={converters:NullableIntConverter}}" />

                    <!-- Description -->
                    <Label Text="Description" />
                    <Editor BackgroundColor="White"
                            Text="{Binding Property.Description}" />

                    <!-- Agent -->
                    <Label Text="Agent*" />
                    <Picker BackgroundColor="White"
                            ItemsSource="{Binding Agents}"
                            ItemDisplayBinding="{Binding Name}"
                            SelectedItem="{Binding SelectedAgent}" />

                </StackLayout>
            </ScrollView>
        </StackLayout>
    </ContentPage.Content>
</ContentPage>
