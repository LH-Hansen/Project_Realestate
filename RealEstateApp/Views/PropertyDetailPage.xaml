<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
    x:Class="RealEstateApp.Views.PropertyDetailPage"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:fa="clr-namespace:FontAwesome"
    xmlns:vm="clr-namespace:RealEstateApp.ViewModels"
    Title="{Binding Property.Address}"
    BackgroundColor="#F5F5F5"
    x:DataType="vm:PropertyDetailPageViewModel">

    <ContentPage.ToolbarItems>
        <ToolbarItem Command="{Binding EditPropertyCommand}" Text="Edit" />
    </ContentPage.ToolbarItems>

    <ScrollView BackgroundColor="#F5F5F5">

        <Grid Padding="15"
              BackgroundColor="#F5F5F5"
              RowDefinitions="Auto,Auto,Auto,Auto,Auto,Auto,Auto,Auto,Auto,Auto,Auto,Auto,Auto"
              RowSpacing="10">

            <!-- Image -->
            <Image Grid.Row="0"
                   Margin="-15,-15,-15,0"
                   Aspect="AspectFill"
                   HeightRequest="225"
                   Source="{Binding Property.MainImageUrl}" />

            <!-- Price -->
            <Label Grid.Row="1"
                   FontAttributes="Bold"
                   FontSize="18"
                   Text="{Binding Property.Price, StringFormat='{0:C0}'}"
                   TextColor="#2E7D32" />

            <!-- Address -->
            <Label Grid.Row="2"
                   FontSize="16"
                   FontAttributes="Bold"
                   Text="{Binding Property.Address}"
                   TextColor="#1F1F1F" />

            <!-- Beds/Baths/Parking -->
            <Grid Grid.Row="3"
                  ColumnDefinitions="Auto,Auto,Auto,Auto,Auto,Auto"
                  ColumnSpacing="10">

                <Label Grid.Column="0"
                       FontFamily="FA-solid"
                       Text="{x:Static fa:IconFont.Bed}" />
                <Label Grid.Column="1"
                       Text="{Binding Property.Beds}" />

                <Label Grid.Column="2"
                       FontFamily="FA-solid"
                       Text="{x:Static fa:IconFont.Bath}" />
                <Label Grid.Column="3"
                       Text="{Binding Property.Baths}" />

                <Label Grid.Column="4"
                       FontFamily="FA-solid"
                       Text="{x:Static fa:IconFont.Parking}" />
                <Label Grid.Column="5"
                       Text="{Binding Property.Parking}" />
            </Grid>

            <!-- Land size -->
            <Label Grid.Row="4"
                   Text="{Binding Property.LandSize,
                          StringFormat='Land size: {0} &#x33a1;'}"
                   TextColor="#757575" />

            <!-- Description header -->
            <Label Grid.Row="5"
                   Margin="0,20,0,0"
                   FontAttributes="Bold"
                   FontSize="15"
                   Text="Description:"
                   TextColor="#1F1F1F" />

            <!-- Description text -->
            <Label Grid.Row="6"
                   Margin="0,0,0,20"
                   FontSize="14"
                   Text="{Binding Property.Description}"
                   TextColor="#424242" />

            <!-- Speech controls -->
            <StackLayout Grid.Row="7"
                         Orientation="Horizontal"
                         Spacing="10">

                <Button FontFamily="FA-solid"
                        Text="{x:Static fa:IconFont.Play}"
                        Command="{Binding SpeakCommand}"
                        IsVisible="{Binding IsNotSpeaking}" />

                <Button FontFamily="FA-solid"
                        Text="{x:Static fa:IconFont.Stop}"
                        Command="{Binding StopCommand}"
                        IsVisible="{Binding IsSpeaking}" />
            </StackLayout>

            <StackLayout Grid.Row="8"
             Orientation="Horizontal"
             Spacing="10">

                <Button FontFamily="FA-solid"
            Text="{x:Static fa:IconFont.MapMarkedAlt}"
            Command="{Binding OpenMapCommand}" />

                <Button FontFamily="FA-solid"
            Text="{x:Static fa:IconFont.Directions}"
            Command="{Binding OpenNavigationCommand}" />

            </StackLayout>


            <!-- Vendor header -->
            <Label Grid.Row="9"
                   FontAttributes="Bold"
                   FontSize="15"
                   Text="Vendor:"
                   TextColor="#1F1F1F" />

            <!-- Vendor info -->
            <StackLayout Grid.Row="10" Spacing="4">

                <Label Text="{Binding Property.Vendor.FullName}" />

                <Label Text="{Binding Property.Vendor.Email}"
       TextColor="Blue">
                    <Label.GestureRecognizers>
                        <TapGestureRecognizer
            Command="{Binding VendorEmailCommand}" />
                    </Label.GestureRecognizers>
                </Label>


                <Label Text="{Binding Property.Vendor.Phone}"
       TextColor="Blue">
                    <Label.GestureRecognizers>
                        <TapGestureRecognizer
            Command="{Binding VendorPhoneCommand}" />
                    </Label.GestureRecognizers>
                </Label>


            </StackLayout>

            <!-- Listed by -->
            <Label Grid.Row="11"
                   FontAttributes="Bold"
                   FontSize="15"
                   Text="Listed by:"
                   TextColor="#1F1F1F" />

            <!-- Agent -->
            <Grid Grid.Row="12"
                  ColumnDefinitions="Auto,*">

                <Image Grid.Column="0"
                       Source="{Binding Agent.ImageUrl}"
                       VerticalOptions="Start"
                       WidthRequest="100" />

                <Grid Grid.Column="1"
                      Margin="10,0,0,0"
                      RowDefinitions="Auto,Auto,Auto"
                      RowSpacing="5">

                    <Label Grid.Row="0"
                           FontAttributes="Bold"
                           FontSize="15"
                           Text="{Binding Agent.Name}" />

                    <Label Grid.Row="1"
                           FontSize="13"
                           Text="{Binding Agent.Email}" />

                    <Label Grid.Row="2"
                           FontSize="13"
                           Text="{Binding Agent.Phone}" />
                </Grid>
            </Grid>

        </Grid>
    </ScrollView>

</ContentPage>
